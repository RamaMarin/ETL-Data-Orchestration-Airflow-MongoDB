[2025-07-15T13:37:27.927+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: main_etl_pipeline.extract_and_load_raw_coinmarketcap_data manual__2025-07-15T13:37:18.251671+00:00 [queued]>
[2025-07-15T13:37:28.150+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: main_etl_pipeline.extract_and_load_raw_coinmarketcap_data manual__2025-07-15T13:37:18.251671+00:00 [queued]>
[2025-07-15T13:37:28.194+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-07-15T13:37:28.548+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): extract_and_load_raw_coinmarketcap_data> on 2025-07-15 13:37:18.251671+00:00
[2025-07-15T13:37:28.709+0000] {standard_task_runner.py:60} INFO - Started process 620 to run task
[2025-07-15T13:37:28.793+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'main_etl_pipeline', 'extract_and_load_raw_coinmarketcap_data', 'manual__2025-07-15T13:37:18.251671+00:00', '--job-id', '108', '--raw', '--subdir', 'DAGS_FOLDER/main_pipeline.py', '--cfg-path', '/tmp/tmp5_gsibew']
[2025-07-15T13:37:28.937+0000] {standard_task_runner.py:88} INFO - Job 108: Subtask extract_and_load_raw_coinmarketcap_data
[2025-07-15T13:37:29.786+0000] {task_command.py:423} INFO - Running <TaskInstance: main_etl_pipeline.extract_and_load_raw_coinmarketcap_data manual__2025-07-15T13:37:18.251671+00:00 [running]> on host 19356e8bdcfc
[2025-07-15T13:37:31.151+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='main_etl_pipeline' AIRFLOW_CTX_TASK_ID='extract_and_load_raw_coinmarketcap_data' AIRFLOW_CTX_EXECUTION_DATE='2025-07-15T13:37:18.251671+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-07-15T13:37:18.251671+00:00'
[2025-07-15T13:37:31.170+0000] {logging_mixin.py:188} INFO - Iniciando extracción de datos de CoinMarketCap desde: https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest
[2025-07-15T13:37:34.922+0000] {logging_mixin.py:188} INFO - Limpiando la colección raw_coinmarketcap_listings antes de insertar nuevos datos crudos...
[2025-07-15T13:37:37.531+0000] {logging_mixin.py:188} INFO - Colección de datos crudos limpiada exitosamente.
[2025-07-15T13:37:37.711+0000] {logging_mixin.py:188} INFO - Datos crudos de CoinMarketCap cargados exitosamente en crypto_data.raw_coinmarketcap_listings.
[2025-07-15T13:37:37.790+0000] {logging_mixin.py:188} INFO - Registros extraídos de CoinMarketCap (crudos): 10
[2025-07-15T13:37:37.980+0000] {python.py:201} INFO - Done. Returned value was: [{'id': 1, 'name': 'Bitcoin', 'symbol': 'BTC', 'slug': 'bitcoin', 'num_market_pairs': 12258, 'date_added': '2010-07-13T00:00:00.000Z', 'tags': ['mineable', 'pow', 'sha-256', 'store-of-value', 'state-channel', 'coinbase-ventures-portfolio', 'three-arrows-capital-portfolio', 'polychain-capital-portfolio', 'binance-labs-portfolio', 'blockchain-capital-portfolio', 'boostvc-portfolio', 'cms-holdings-portfolio', 'dcg-portfolio', 'dragonfly-capital-portfolio', 'electric-capital-portfolio', 'fabric-ventures-portfolio', 'framework-ventures-portfolio', 'galaxy-digital-portfolio', 'huobi-capital-portfolio', 'alameda-research-portfolio', 'a16z-portfolio', '1confirmation-portfolio', 'winklevoss-capital-portfolio', 'usv-portfolio', 'placeholder-ventures-portfolio', 'pantera-capital-portfolio', 'multicoin-capital-portfolio', 'paradigm-portfolio', 'bitcoin-ecosystem', 'layer-1', 'ftx-bankruptcy-estate', '2017-2018-alt-season', 'us-strategic-crypto-reserve', 'binance-ecosystem', 'binance-listing'], 'max_supply': 21000000, 'circulating_supply': 19892746, 'total_supply': 19892746, 'infinite_supply': False, 'platform': None, 'cmc_rank': 1, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 117965.30217976711, 'volume_24h': 136504401985.91687, 'volume_change_24h': 3.8628, 'percent_change_1h': 0.49193997, 'percent_change_24h': -2.69863705, 'percent_change_7d': 8.44651662, 'percent_change_30d': 11.87486686, 'percent_change_60d': 13.7186731, 'percent_change_90d': 40.54502127, 'market_cap': 2346653793075.3535, 'market_cap_dominance': 63.4214, 'fully_diluted_market_cap': 2477271345775.11, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 1027, 'name': 'Ethereum', 'symbol': 'ETH', 'slug': 'ethereum', 'num_market_pairs': 10396, 'date_added': '2015-08-07T00:00:00.000Z', 'tags': ['pos', 'smart-contracts', 'ethereum-ecosystem', 'coinbase-ventures-portfolio', 'three-arrows-capital-portfolio', 'polychain-capital-portfolio', 'binance-labs-portfolio', 'blockchain-capital-portfolio', 'boostvc-portfolio', 'cms-holdings-portfolio', 'dcg-portfolio', 'dragonfly-capital-portfolio', 'electric-capital-portfolio', 'fabric-ventures-portfolio', 'framework-ventures-portfolio', 'hashkey-capital-portfolio', 'kenetic-capital-portfolio', 'huobi-capital-portfolio', 'alameda-research-portfolio', 'a16z-portfolio', '1confirmation-portfolio', 'winklevoss-capital-portfolio', 'usv-portfolio', 'placeholder-ventures-portfolio', 'pantera-capital-portfolio', 'multicoin-capital-portfolio', 'paradigm-portfolio', 'ethereum-pow-ecosystem', 'layer-1', 'ftx-bankruptcy-estate', 'sora-ecosystem', 'rsk-rbtc-ecosystem', 'world-liberty-financial-portfolio', 'us-strategic-crypto-reserve', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 120714500.83952598, 'total_supply': 120714500.83952598, 'infinite_supply': True, 'platform': None, 'cmc_rank': 2, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 3030.247279086078, 'volume_24h': 29788650117.654667, 'volume_change_24h': -5.0108, 'percent_change_1h': 0.87488991, 'percent_change_24h': -0.15985579, 'percent_change_7d': 17.62162104, 'percent_change_30d': 19.62781755, 'percent_change_60d': 16.24777673, 'percent_change_90d': 92.3417608, 'market_cap': 365794787715.2077, 'market_cap_dominance': 9.8861, 'fully_diluted_market_cap': 365794787715.21, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 52, 'name': 'XRP', 'symbol': 'XRP', 'slug': 'xrp', 'num_market_pairs': 1652, 'date_added': '2013-08-04T00:00:00.000Z', 'tags': ['medium-of-exchange', 'enterprise-solutions', 'xrp-ecosystem', 'arrington-xrp-capital-portfolio', 'galaxy-digital-portfolio', 'a16z-portfolio', 'pantera-capital-portfolio', 'ftx-bankruptcy-estate', '2017-2018-alt-season', 'klaytn-ecosystem', 'made-in-america', 'us-strategic-crypto-reserve', 'binance-ecosystem', 'binance-listing'], 'max_supply': 100000000000, 'circulating_supply': 59131625363, 'total_supply': 99985946231, 'infinite_supply': False, 'platform': None, 'cmc_rank': 3, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 2.909773071296731, 'volume_24h': 10260358340.359327, 'volume_change_24h': -11.5421, 'percent_change_1h': -0.26280829, 'percent_change_24h': -2.14921998, 'percent_change_7d': 27.17874581, 'percent_change_30d': 34.17719647, 'percent_change_60d': 19.57200107, 'percent_change_90d': 40.02829912, 'market_cap': 172059611143.2642, 'market_cap_dominance': 4.6501, 'fully_diluted_market_cap': 290977307129.67, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 825, 'name': 'Tether USDt', 'symbol': 'USDT', 'slug': 'tether', 'num_market_pairs': 136813, 'date_added': '2015-02-25T00:00:00.000Z', 'tags': ['stablecoin', 'asset-backed-stablecoin', 'usd-stablecoin', 'ethereum-pow-ecosystem', 'fiat-stablecoin', 'tron20-ecosystem', 'rsk-rbtc-ecosystem', 'world-liberty-financial-portfolio', 'binance-ecosystem', 'binance-listing', 'peaq-ecosystem', 'apertum-ecosystem'], 'max_supply': None, 'circulating_supply': 159886922749.03622, 'total_supply': 161817320301.32947, 'platform': {'id': 1027, 'name': 'Ethereum', 'symbol': 'ETH', 'slug': 'ethereum', 'token_address': '***'}, 'infinite_supply': True, 'cmc_rank': 4, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:35:00.000Z', 'quote': {'USD': {'price': 0.9998309397264348, 'volume_24h': 134720717324.51234, 'volume_change_24h': 5.4897, 'percent_change_1h': -0.00434227, 'percent_change_24h': -0.01358136, 'percent_change_7d': -0.01615749, 'percent_change_30d': -0.03780633, 'percent_change_60d': -0.02521246, 'percent_change_90d': -0.01246082, 'market_cap': 159859892222.13678, 'market_cap_dominance': 4.3216, 'fully_diluted_market_cap': 161789963420.89, 'tvl': None, 'last_updated': '2025-07-15T13:35:00.000Z'}}}, {'id': 1839, 'name': 'BNB', 'symbol': 'BNB', 'slug': 'bnb', 'num_market_pairs': 2620, 'date_added': '2017-07-25T00:00:00.000Z', 'tags': ['marketplace', 'centralized-exchange', 'payments', 'smart-contracts', 'alameda-research-portfolio', 'multicoin-capital-portfolio', 'bnb-chain-ecosystem', 'layer-1', 'alleged-sec-securities', 'celsius-bankruptcy-estate', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 139289233.48, 'total_supply': 139289233.48, 'infinite_supply': False, 'platform': None, 'cmc_rank': 5, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 683.2814618038666, 'volume_24h': 2128142041.6378486, 'volume_change_24h': -7.0103, 'percent_change_1h': 0.16499084, 'percent_change_24h': -2.70032893, 'percent_change_7d': 3.44663607, 'percent_change_30d': 5.2302276, 'percent_change_60d': 4.48799276, 'percent_change_90d': 17.66508825, 'market_cap': 95173751065.75447, 'market_cap_dominance': 2.5722, 'fully_diluted_market_cap': 95173751065.75, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 5426, 'name': 'Solana', 'symbol': 'SOL', 'slug': 'solana', 'num_market_pairs': 953, 'date_added': '2020-04-10T00:00:00.000Z', 'tags': ['pos', 'platform', 'solana-ecosystem', 'cms-holdings-portfolio', 'kenetic-capital-portfolio', 'alameda-research-portfolio', 'multicoin-capital-portfolio', 'okx-ventures-portfolio', 'layer-1', 'ftx-bankruptcy-estate', 'alleged-sec-securities', 'cmc-crypto-awards-2024', 'made-in-america', 'us-strategic-crypto-reserve', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 536279207.2395418, 'total_supply': 605319895.2021589, 'infinite_supply': True, 'platform': None, 'cmc_rank': 6, 'self_reported_circulating_supply': 525236893.3, 'self_reported_market_cap': 84354631216.57541, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:35:00.000Z', 'quote': {'USD': {'price': 160.60301988039234, 'volume_24h': 6062823925.154379, 'volume_change_24h': -6.2794, 'percent_change_1h': -0.02579293, 'percent_change_24h': -3.77321182, 'percent_change_7d': 5.78869351, 'percent_change_30d': 9.08202566, 'percent_change_60d': -7.15212254, 'percent_change_90d': 28.43955773, 'market_cap': 86128060181.73318, 'market_cap_dominance': 2.3296, 'fully_diluted_market_cap': 97216203163.15, 'tvl': None, 'last_updated': '2025-07-15T13:35:00.000Z'}}}, {'id': 3408, 'name': 'USDC', 'symbol': 'USDC', 'slug': 'usd-coin', 'num_market_pairs': 29343, 'date_added': '2018-10-08T00:00:00.000Z', 'tags': ['medium-of-exchange', 'stablecoin', 'asset-backed-stablecoin', 'coinbase-ventures-portfolio', 'usd-stablecoin', 'ethereum-pow-ecosystem', 'fiat-stablecoin', 'tron20-ecosystem', 'made-in-america', 'world-liberty-financial-portfolio', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 62837139207.10588, 'total_supply': 62837139207.10588, 'platform': {'id': 1027, 'name': 'Ethereum', 'symbol': 'ETH', 'slug': 'ethereum', 'token_address': '***'}, 'infinite_supply': False, 'cmc_rank': 7, 'self_reported_circulating_supply': 60901219650.23, 'self_reported_market_cap': 60895534124.9327, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:35:00.000Z', 'quote': {'USD': {'price': 0.9999066434903938, 'volume_24h': 17558968090.549778, 'volume_change_24h': 14.9906, 'percent_change_1h': 0.00417038, 'percent_change_24h': 0.00790549, 'percent_change_7d': -0.00088245, 'percent_change_30d': 0.00503122, 'percent_change_60d': 0.01243198, 'percent_change_90d': -0.00637379, 'market_cap': 62831272951.11587, 'market_cap_dominance': 1.6994, 'fully_diluted_market_cap': 62831272951.12, 'tvl': None, 'last_updated': '2025-07-15T13:35:00.000Z'}}}, {'id': 74, 'name': 'Dogecoin', 'symbol': 'DOGE', 'slug': 'dogecoin', 'num_market_pairs': 1257, 'date_added': '2013-12-15T00:00:00.000Z', 'tags': ['mineable', 'pow', 'scrypt', 'medium-of-exchange', 'memes', 'payments', 'doggone-doggerel', 'osmosis-ecosystem', 'ftx-bankruptcy-estate', 'animal-memes', 'made-in-america', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 150105916383.7052, 'total_supply': 150105916383.7052, 'infinite_supply': True, 'platform': None, 'cmc_rank': 8, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 0.19344151234521254, 'volume_24h': 2171146018.927665, 'volume_change_24h': -13.2262, 'percent_change_1h': -0.21541766, 'percent_change_24h': -5.3511989, 'percent_change_7d': 13.61370419, 'percent_change_30d': 10.34146877, 'percent_change_60d': -15.42305115, 'percent_change_90d': 26.43562307, 'market_cap': 29036715477.22795, 'market_cap_dominance': 0.7848, 'fully_diluted_market_cap': 29036715477.23, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 1958, 'name': 'TRON', 'symbol': 'TRX', 'slug': 'tron', 'num_market_pairs': 1202, 'date_added': '2017-09-13T00:00:00.000Z', 'tags': ['media', 'payments', 'tron-ecosystem', 'layer-1', 'dwf-labs-portfolio', 'alleged-sec-securities', '2017-2018-alt-season', 'tron20-ecosystem', 'world-liberty-financial-portfolio', 'binance-ecosystem', 'binance-listing'], 'max_supply': None, 'circulating_supply': 94755702672.07538, 'total_supply': 94755725774.25139, 'infinite_supply': True, 'platform': None, 'cmc_rank': 9, 'self_reported_circulating_supply': 71659659264, 'self_reported_market_cap': 21276676423.357292, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 0.2969128885328953, 'volume_24h': 940347911.6936204, 'volume_change_24h': 2.3877, 'percent_change_1h': -0.17551864, 'percent_change_24h': -1.49850433, 'percent_change_7d': 3.55229953, 'percent_change_30d': 8.84022121, 'percent_change_60d': 9.38663647, 'percent_change_90d': 16.95874432, 'market_cap': 28134189385.33009, 'market_cap_dominance': 0.7604, 'fully_diluted_market_cap': 28134196244.66, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}, {'id': 2010, 'name': 'Cardano', 'symbol': 'ADA', 'slug': 'cardano', 'num_market_pairs': 1548, 'date_added': '2017-10-01T00:00:00.000Z', 'tags': ['dpos', 'pos', 'platform', 'research', 'smart-contracts', 'staking', 'cardano-ecosystem', 'cardano', 'layer-1', 'alleged-sec-securities', '2017-2018-alt-season', 'made-in-america', 'us-strategic-crypto-reserve', 'binance-ecosystem', 'binance-listing'], 'max_supply': 45000000000, 'circulating_supply': 35395351625.88492, 'total_supply': 44994779503.81775, 'infinite_supply': False, 'platform': None, 'cmc_rank': 10, 'self_reported_circulating_supply': None, 'self_reported_market_cap': None, 'tvl_ratio': None, 'last_updated': '2025-07-15T13:36:00.000Z', 'quote': {'USD': {'price': 0.7335334096876535, 'volume_24h': 1481298086.2713568, 'volume_change_24h': -16.9345, 'percent_change_1h': 0.13451258, 'percent_change_24h': -2.23958082, 'percent_change_7d': 25.51731135, 'percent_change_30d': 16.33136052, 'percent_change_60d': -6.26147638, 'percent_change_90d': 21.3089849, 'market_cap': 25963672965.228794, 'market_cap_dominance': 0.7017, 'fully_diluted_market_cap': 33009003435.94, 'tvl': None, 'last_updated': '2025-07-15T13:36:00.000Z'}}}]
[2025-07-15T13:37:38.138+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=main_etl_pipeline, task_id=extract_and_load_raw_coinmarketcap_data, execution_date=20250715T133718, start_date=20250715T133728, end_date=20250715T133738
[2025-07-15T13:37:38.311+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-07-15T13:37:38.512+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
